
<!doctype html>
<html lang="es">
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Flujo de Trabajo</title>
  <style>
   :root { --bg:#0b1020; --panel:#141a2e; --muted:#a7b0c0; --text:#e8ecf3; --accent:#3aa9ff; --accent-2:#7c4dff; --ok:#22c55e; }
   * { box-sizing: border-box; }
   html, body { height: 100%; }
   body { margin: 0; background: linear-gradient(180deg, #0b1020, #0b1226); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
   .wrap { max-width: 1600px; margin: 0 auto; padding: 28px; }
   h1 { font-size: 30px; letter-spacing: .3px; margin: 8px 0 14px; }
   p.lead { color: var(--muted); margin: 0 0 22px; }

   .flow { display: grid; grid-template-columns: repeat(24, 1fr); gap: 24px; align-items: start; margin-top: 28px; }
   /* Disposición circular */
   .flow--circle { position: relative; display:block; height: 860px; margin-top: 16px; }
   .flow--circle .ring { position:absolute; top:50%; left:50%; width: 900px; height: 900px; transform: translate(-50%,-50%); border: 2px dashed rgba(58,169,255,.35); border-radius: 50%; opacity: .35; z-index:0; pointer-events:none; animation: spin 60s linear infinite; }
   .flow--circle .step { position:absolute; width: 380px; z-index:3; }
   .flow--circle .step--actividad { width: 500px; }
   .flow--circle .step--pruebas { width: 500px; }
   .flow--circle .arrow { display:none; }
   .flow--circle .connectors { position:absolute; top:50%; left:50%; width:900px; height:900px; transform: translate(-50%,-50%); pointer-events:none; z-index:1; animation: spin 60s linear infinite; }
   .flow--circle .label { position:absolute; color: var(--muted); font-size: 12px; background: rgba(20,26,46,.7); backdrop-filter: blur(2px); border:1px solid rgba(255,255,255,.08); padding:4px 8px; border-radius:999px; }
   .flow--circle .step { box-shadow: 0 10px 30px rgba(0,0,0,.25); border-color: rgba(255,255,255,.12); }
   @keyframes spin { from { transform: translate(-50%,-50%) rotate(0deg); } to { transform: translate(-50%,-50%) rotate(360deg); } }
   /* Posiciones alrededor del círculo */
   .pos-actividad { top: 50%; left: 0%; transform: translate(0,-50%); }
   .pos-pruebas   { top: -4%;  left: 54%; transform: translate(-50%,0); }
   .pos-inspeccion{ top: 28%; left: 85%; transform: translate(-50%,0); }
   .pos-tareas    { top: 70%; left: 82%; transform: translate(-50%,0); }
   .pos-reporte   { top: 106%; left: 50%; transform: translate(-50%,-100%); }
   .cycle-note { position:absolute; left:50%; bottom: 14px; transform: translateX(-50%); color: var(--muted); font-size: 13px; }
   .step { grid-column: span 4; background: radial-gradient(1200px 420px at -10% -20%, rgba(122, 168, 255, .18), transparent 55%),
                           radial-gradient(300px 200px at 110% 130%, rgba(124, 77, 255, .16), transparent 60%),
                           var(--panel);
           border: 1px solid rgba(255, 255, 255, .08);
           border-radius: 16px; padding: 18px; position: relative; display: flex; flex-direction: column; min-height: 200px; }
   .step--actividad { grid-column: span 6; }
   .step h2 { font-size: 18px; margin: 0 0 8px; display: flex; flex-direction: column; align-items: flex-start; gap: 2px; }
   .step h2 .icon { display:inline-flex; align-items:center; justify-content:center; width:24px; height:24px; border-radius:8px; background: rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); margin-right:8px; }
   .step .title-row { display:flex; align-items:center; gap:8px; }
   .step h2 small { display: block; }
   .step small { color: var(--muted); font-weight: 500; }
   .docs { margin: 6px 0 0; padding-left: 14px; color: var(--muted); padding-right:8px; word-break: break-word; font-size: 13.5px; }
   .docs li { margin: 6px 0; line-height: 1.45; }
   .arrow { grid-column: span 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--muted); gap:10px; margin-top: 22px; }
   .arrow .shaft { width: 100%; height: 2px; background: repeating-linear-gradient(90deg, rgba(58,169,255,.0) 0 8px, rgba(58,169,255,.9) 8px 16px); position: relative; opacity:.9; }
   .arrow .shaft::after { content: ""; position: absolute; right: -2px; top: 50%; transform: translateY(-50%) rotate(0deg); border-left: 8px solid rgba(58, 169, 255, .9); border-top: 6px solid transparent; border-bottom: 6px solid transparent; }
   .arrow .label { font-size: 13px; color: var(--muted); text-align:center; max-width: 10ch; }

   .step--inventario h2 { color: var(--accent); }
   .step--actividad h2 { color: var(--accent); }
   .step--pruebas h2 { color: #ffd166; }
   .step--inspeccion h2 { color: var(--accent-2); }
   .step--tareas h2 { color: #22d3ee; }
   .step--reporte h2 { color: var(--ok); }

   .legend { display: flex; gap: 12px; flex-wrap: wrap; margin: 16px 0 0; color: var(--muted); font-size: 13px; }
   .pill { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: 999px; background: rgba(255,255,255,.06); border: 1px solid rgba(255,255,255,.08); }
   .dot { width: 8px; height: 8px; border-radius: 50%; }
   .chips { display:flex; flex-wrap:wrap; gap:6px; margin-top:6px; }
   .chip { font-size:12px; color:#cbd5e1; border:1px dashed rgba(255,255,255,.22); background: rgba(255,255,255,.05); padding:4px 8px; border-radius:999px; }
   .chip--dep { color:#bfdbfe; border-color: rgba(59,130,246,.35); background: rgba(59,130,246,.14); }
   .chip--crea { color:#bbf7d0; border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.14); }
   .chip--area { color:#e9d5ff; border-color: rgba(168,85,247,.35); background: rgba(168,85,247,.14); }
   .chip--edo { color:#fde68a; border-color: rgba(234,179,8,.45); background: rgba(234,179,8,.14); }
   .chip--osoc { color:#a7f3d0; border-color: rgba(16,185,129,.45); background: rgba(16,185,129,.14); }
   .step .bubble { position:absolute; top:10px; right:10px; font-size:11px; color:#0b1020; background:#fef3c7; border:1px solid #fde68a; border-radius:999px; padding:2px 8px; font-weight:700; }
   .chip-legend { margin-top: 10px; color: var(--muted); font-size: 12px; display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
   .chip-legend .title { font-weight:600; color:#9ca3af; margin-right:4px; }

   /* Layout móvil: tarjetas apiladas con flechas verticales, sin animación circular */
   @media (max-width: 980px) {
    .flow { grid-template-columns: 1fr; }
    .flow--circle { height: auto; margin-top: 12px; }
    .flow--circle .ring,
    .flow--circle .connectors,
    .cycle-note { display: none; }
    .flow--circle .step { position: static; width: 100%; max-width: 100%; margin-bottom: 14px; }
    .flow--circle .step--actividad,
    .flow--circle .step--pruebas { width: 100%; }
    .pos-actividad,
    .pos-pruebas,
    .pos-inspeccion,
    .pos-tareas,
    .pos-reporte { top:auto; left:auto; transform:none; }
    .flow--circle .arrow { display:flex; margin: 4px 0 12px; }
    .arrow .shaft { width: 2px; height: 48px; background: linear-gradient(180deg, rgba(58,169,255,.0), rgba(58,169,255,.9)); }
    .arrow .shaft::after { right: 50%; top: unset; bottom: -2px; transform: translateX(50%) rotate(90deg); }
   }
  </style>
 </head>
 <body>
  <main class="wrap" aria-label="Flujo de trabajo">
   <h1>Flujo de trabajo</h1>
   <p class="lead">Flujo: Actividad (creación) → Pruebas → Inspección → Tareas → Reporte.</p>

   <section class="flow flow--circle" aria-label="Etapas del flujo">
    <div class="ring" aria-hidden="true"></div>
    <div class="connectors" aria-hidden="true">
      <svg viewBox="0 0 900 900" fill="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
            <path d="M 0 0 L 10 5 L 0 10 z" fill="rgba(58,169,255,.9)" />
          </marker>
        </defs>
        <!-- Arcos alrededor del anillo (centro 450,450 radio 420) -->
        <!-- Actividad -> Pruebas (izquierda a arriba) -->
        <path d="M 30 450 A 420 420 0 0 1 450 30" stroke="rgba(58,169,255,.9)" stroke-width="2" stroke-dasharray="6 8" marker-end="url(#arrow)" />
        <!-- Pruebas -> Inspección (arriba a arriba-derecha) -->
        <path d="M 450 30 A 420 420 0 0 1 810 270" stroke="#ffd166" stroke-width="2" stroke-dasharray="6 8" marker-end="url(#arrow)" />
        <!-- Inspección -> Tareas (arriba-derecha a abajo-derecha) -->
        <path d="M 810 270 A 420 420 0 0 1 810 630" stroke="#7c4dff" stroke-width="2" stroke-dasharray="6 8" marker-end="url(#arrow)" />
        <!-- Tareas -> Dashboard (abajo-derecha a abajo) -->
        <path d="M 810 630 A 420 420 0 0 1 450 870" stroke="#22d3ee" stroke-width="2" stroke-dasharray="6 8" marker-end="url(#arrow)" />
        <!-- Dashboard -> Actividad (abajo a izquierda) -->
        <path d="M 450 870 A 420 420 0 0 1 30 450" stroke="#22c55e" stroke-width="2" stroke-dasharray="6 8" marker-end="url(#arrow)" />
      </svg>
      <!-- Etiquetas en puntos del anillo -->
      <div class="label" style="top: 18%; left: 46%; transform: translate(-50%,-50%);">Genera órdenes de prueba</div>
      <div class="label" style="top: 26%; right: 12%; transform: translate(50%,-50%);">Checklist y evidencias</div>
      <div class="label" style="bottom: 22%; right: 12%; transform: translate(50%,50%);">Tareas operativas</div>
      <div class="label" style="bottom: 10%; left: 50%; transform: translate(-50%,50%);">KPIs y tableros</div>
    </div>
    <article class="step step--actividad pos-actividad" aria-labelledby="titulo-actividad">
     <div class="bubble">1</div>
     <h2 id="titulo-actividad">Actividad<br> <small>(creación)</small></h2>
     <ul class="docs" aria-label="Actividad: entradas, reglas y salidas">
      <li><strong>Entrada</strong>: equipo(s) o lote, cliente, fechas, precio, OS/OC.</li>
      <li><strong>Datos base</strong>: inventario.csv + unificado → serial, descripción, diámetro, figura.</li>
      <li><strong>Reglas</strong>:
        <br>• Solo equipos con EDO=ON (EDO lo cambia un admin en inventario.html).
        <br>• Lote: N equipos ⇒ N órdenes de prueba.
        <br>• Pruebas por equipo mapeadas desde inventario.csv y catálogo de stockpruebas.html (LT, VT/PT/MT, UTT, etc.).
      </li>
      <li><strong>Salida</strong>: actividad creada + cola de órdenes de prueba por equipo; visible en regactividad (operación) y actividadmin (administración).</li>
     </ul>
     <div class="chips" aria-label="Dependencias y salidas">
      <span class="chip chip--dep">Depende: inventario.csv</span>
      <span class="chip chip--dep">Depende: unificado.csv</span>
      <span class="chip chip--osoc">Requiere: OS / OC</span>
      <span class="chip chip--edo">Solo EDO = ON</span>
      <span class="chip chip--crea">Crea: órdenes de prueba</span>
      <span class="chip chip--crea">Crea: regactividad</span>
      <span class="chip chip--crea">Crea: actividadmin</span>
      <span class="chip chip--area">Áreas: Operación</span>
      <span class="chip chip--area">Áreas: Administración</span>
     </div>
    </article>
    <div class="arrow" aria-hidden="true"><div class="shaft"></div><div class="label">Genera órdenes de prueba por equipo (EDO=ON)</div></div>

    <article class="step step--pruebas pos-pruebas" aria-labelledby="titulo-pruebas">
     <div class="bubble">2</div>
     <h2 id="titulo-pruebas">Pruebas <br> <small>(validación)</small></h2>
     <ul class="docs" aria-label="Pruebas: asignación y operación">
      <li><strong>Entrada</strong>: órdenes generadas por Actividad (solo EDO=ON).</li>
      <li><strong>Asignación</strong>: por equipo se instancian las pruebas requeridas (LT, VT/PT/MT, UTT, etc.) según inventario.csv/stockpruebas.html.</li>
      <li><strong>Operación</strong>: captura de resultados y observaciones; registro PND.</li>
      <li><strong>Salida</strong>: estado de pruebas por equipo para etapas siguientes.</li>
     </ul>
     <div class="chips" aria-label="Dependencias y salidas">
      <span class="chip chip--dep">Depende: órdenes de prueba</span>
      <span class="chip chip--dep">Depende: inventario.csv</span>
      <span class="chip chip--dep">Depende: stockpruebas.html</span>
      <span class="chip chip--crea">Crea: Registro PND</span>
      <span class="chip chip--area">Áreas: PND / Calidad</span>
     </div>
    </article>
    <div class="arrow" aria-hidden="true"><div class="shaft"></div><div class="label">Checklist, hallazgos y evidencias</div></div>

    <article class="step step--inspeccion pos-inspeccion" aria-labelledby="titulo-inspeccion">
     <div class="bubble">3</div>
     <h2 id="titulo-inspeccion">Inspección<br> <small>(control)</small></h2>
     <ul class="docs" aria-label="Documentos de inspección">
      <li>Selección de equipo solo si EDO=ON</li>
      <li>Checklists, hallazgos y fotos</li>
      <li>Registro de inspecciones</li>
     </ul>
     <div class="chips" aria-label="Dependencias y salidas">
      <span class="chip chip--dep">Depende: estado de pruebas</span>
      <span class="chip chip--crea">Crea: reginspecciones</span>
      <span class="chip chip--area">Áreas: Inspección / Calidad</span>
     </div>
    </article>
    <div class="arrow" aria-hidden="true"><div class="shaft"></div><div class="label">Tareas operativas</div></div>

    <article class="step step--tareas pos-tareas" aria-labelledby="titulo-tareas">
     <div class="bubble">4</div>
     <h2 id="titulo-tareas">Tareas<br> <small>(servicio)</small></h2>
     <ul class="docs" aria-label="Documentos de tareas">
      <li>Propio / Terceros (nuevo flujo)</li>
      <li>Firestore: activityRecords</li>
      <li>Bloquea equipos con EDO=OFF</li>
     </ul>
     <div class="chips" aria-label="Dependencias y salidas">
      <span class="chip chip--dep">Depende: Actividad</span>
      <span class="chip chip--crea">Crea: tareas</span>
      <span class="chip chip--area">Áreas: Operación</span>
     </div>
    </article>
    <div class="arrow" aria-hidden="true"><div class="shaft"></div><div class="label">KPIs y tableros</div></div>

    <article class="step step--reporte pos-reporte" aria-labelledby="titulo-reporte">
     <div class="bubble">5</div>
     <h2 id="titulo-reporte">Dashboard<br> <small>(salida)</small></h2>
     <ul class="docs" aria-label="Documentos de reporte">
      <li>KPIs Actividades: Activas, Vencidas</li>
      <li>Promedio días en servicio</li>
      <li>Inventario total</li>
     </ul>
     <div class="chips" aria-label="Dependencias y salidas">
      <span class="chip chip--dep">Depende: activityRecords</span>
      <span class="chip chip--dep">Depende: PND / Inspecciones</span>
      <span class="chip chip--area">Áreas: Dirección / Operación</span>
     </div>
    </article>
    <div class="cycle-note">↺ Reinicia ciclo: Dashboard → Actividad</div>
   </section>

   <div class="legend" aria-label="Leyenda de colores">
    <span class="pill"><span class="dot" style="background: var(--accent);"></span> Actividad</span>
    <span class="pill"><span class="dot" style="background: #ffd166;"></span> Pruebas</span>
    <span class="pill"><span class="dot" style="background: var(--accent-2);"></span> Inspección</span>
    <span class="pill"><span class="dot" style="background: #22d3ee;"></span> Tareas</span>
    <span class="pill"><span class="dot" style="background: var(--ok);"></span> Reporte</span>
   </div>
   <div class="chip-legend" aria-label="Glosario de chips">
    <span class="title">Glosario (chips):</span>
    <span class="chip chip--dep">Dependencias</span>
    <span class="chip chip--crea">Documentos creados</span>
    <span class="chip chip--area">Áreas</span>
    <span class="chip chip--osoc">OS/OC requeridos</span>
    <span class="chip chip--edo">EDO=ON</span>
   </div>
  </main>
 </body>
 </html>

